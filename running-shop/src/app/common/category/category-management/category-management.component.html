<p-toast></p-toast>

<div class="container-fluid">
  <div class="card">
    <div class="flex justify-content-between align-items-center mb-4">
      <h2>Quản Lý Danh Mục</h2>
      <div class="flex gap-2">
        <div class="p-input-icon-left">
          <i class="pi pi-search"></i>
          <input pInputText class="custom-input" [(ngModel)]="searchKeyword" placeholder="Tìm kiếm danh mục..." (input)="searchCategories()" />
        </div>
        <p-button label="Thêm Danh Mục" icon="pi pi-plus" styleClass="p-button-primary" (click)="showDialog('add')"></p-button>
      </div>
    </div>

    <p-table [value]="categories" [tableStyle]="{ 'min-width': '50rem' }">
      <ng-template pTemplate="header">
        <tr>
          <th>Tên</th>
          <th>Mô tả</th>
          <th style="width: 12rem">Hành động</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-category>
        <tr>
          <td>{{ category.name }}</td>
          <td>{{ category.description || 'N/A' }}</td>
          <td>
            <div class="action-buttons">
              <p-button icon="pi pi-eye" styleClass="p-button-text" (click)="showDialog('detail', category)"></p-button>
              <p-button icon="pi pi-pencil" styleClass="p-button-text" (click)="showDialog('edit', category)"></p-button>
              <p-button icon="pi pi-trash" styleClass="p-button-text p-button-danger" (click)="deleteCategory(category.id)"></p-button>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>

    <div class="mobile-view">
      <div class="category-cards">
        <div class="category-card" *ngFor="let category of categories">
          <div class="category-info">
            <h3>{{ category.name }}</h3>
            <p><strong>Mô tả:</strong> {{ category.description || 'N/A' }}</p>
          </div>
          <div class="action-buttons">
            <p-button icon="pi pi-eye" styleClass="p-button-text" (click)="showDialog('detail', category)"></p-button>
            <p-button icon="pi pi-pencil" styleClass="p-button-text" (click)="showDialog('edit', category)"></p-button>
            <p-button icon="pi pi-trash" styleClass="p-button-text p-button-danger" (click)="deleteCategory(category.id)"></p-button>
          </div>
        </div>
        <div class="no-categories" *ngIf="!categories.length">Không có danh mục nào</div>
      </div>
    </div>
  </div>
</div>

<app-add-category
  [visible]="dialogVisible"
  [mode]="dialogMode"
  [category]="selectedCategory"
  (visibleChange)="dialogVisible = $event"
  (save)="handleSave()"
></app-add-category>
